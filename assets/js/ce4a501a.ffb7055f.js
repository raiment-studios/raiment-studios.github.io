"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[695],{9524:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>a,default:()=>m,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var i=t(4848),o=t(8453);const s={},a="Early WIP: voxel chunking",l={permalink:"/blog/2024/08/21/index",editUrl:"https://github.com/raiment-studios/monorepo/tree/main/projects/raiment-studios/web2/blog/2024-08-21/index.md",source:"@site/blog/2024-08-21/index.md",title:"Early WIP: voxel chunking",description:"A very work-in-progress implementation of voxel chunking and generation.",date:"2024-08-21T00:00:00.000Z",tags:[],readingTime:2.275,hasTruncateMarker:!1,authors:[],frontMatter:{},unlisted:!1,nextItem:{title:"Plugins as dylibs",permalink:"/blog/2024/08/20/index"}},r={authorsImageUrls:[]},c=[{value:"Pseudo-code",id:"pseudo-code",level:4},{value:"Work-in-progress",id:"work-in-progress",level:4},{value:"Approaching new code",id:"approaching-new-code",level:4}];function d(e){const n={code:"code",h4:"h4",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"A very work-in-progress implementation of voxel chunking and generation."}),"\n",(0,i.jsx)(n.h4,{id:"pseudo-code",children:"Pseudo-code"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Cache\n    entries : Map<Cell position, Entry>\n\nEntry\n    timestamp\n    instance_id\n\nupdate_cells:\n    compute a NxNxM bounds around the camera\n    transform the corners to cell coordinates\n        cells are 32x32x8\n\n    scan each cell in the bounds\n        if cache[cell coords] is empty\n            add a new entry\n        entry.timestamp = now\n\n    for each cache entry\n        if entry.timestamp > AGE\n            remove instance.id from scene\n            drop entry\n        else if entry has no model instance\n            instance = call generator(cell bounds)\n            entry.id = instance.id\n            add instance to scene\n"})}),"\n",(0,i.jsx)(n.h4,{id:"work-in-progress",children:"Work-in-progress"}),"\n",(0,i.jsx)(n.p,{children:"The below gets the basic pseudo-code going, which was the goal. It has a number of issues, which were intentionally deferred to be addressed later:"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ",'The generator simply clones a fixed tile instance. It\'s not a "real" generator']}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","The load/discard of new tiles has a lot of stutter as many tiles get added / removed at once"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","The potential visible set bounds are intentionally small for debugging"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","General performance: this does a lot of work, which doesn't seem scalable without refinement"]}),"\n"]}),"\n",(0,i.jsx)("video",{src:"https://private-user-images.githubusercontent.com/65878718/360005484-1983bce8-dad8-4fd9-ad6d-f299dfc78ba7.mov?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjQyNTg4NjIsIm5iZiI6MTcyNDI1ODU2MiwicGF0aCI6Ii82NTg3ODcxOC8zNjAwMDU0ODQtMTk4M2JjZTgtZGFkOC00ZmQ5LWFkNmQtZjI5OWRmYzc4YmE3Lm1vdj9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA4MjElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwODIxVDE2NDI0MlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTJlOThiYzg1NzUzZDU4MzJmMzViYjU4YjdhN2I1YjRjZWYyNjMyYzJiOGMzZjU2Nzg2MThkYmExYzU0ZTg1ZGQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.2kOrPbo8UdqfvzimVfXoRstGF3Z_Bohx9UYZiJ1kYdY","data-canonical-src":"https://private-user-images.githubusercontent.com/65878718/360005484-1983bce8-dad8-4fd9-ad6d-f299dfc78ba7.mov?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjQyNTg4NjIsIm5iZiI6MTcyNDI1ODU2MiwicGF0aCI6Ii82NTg3ODcxOC8zNjAwMDU0ODQtMTk4M2JjZTgtZGFkOC00ZmQ5LWFkNmQtZjI5OWRmYzc4YmE3Lm1vdj9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA4MjElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwODIxVDE2NDI0MlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTJlOThiYzg1NzUzZDU4MzJmMzViYjU4YjdhN2I1YjRjZWYyNjMyYzJiOGMzZjU2Nzg2MThkYmExYzU0ZTg1ZGQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.2kOrPbo8UdqfvzimVfXoRstGF3Z_Bohx9UYZiJ1kYdY",controls:"controls",muted:"muted",class:"d-block rounded-bottom-2 border-top width-fit"}),"\n",(0,i.jsx)(n.h4,{id:"approaching-new-code",children:"Approaching new code"}),"\n",(0,i.jsx)(n.p,{children:"A bit about how I approach new work where I personally don't know exactly what needs to be done."}),"\n",(0,i.jsx)(n.p,{children:"Note that step (2c) is (surprisingly?) often the easiest step to ignore yet the most beneficial to do well in terms of it's impact of understanding the problem space and implementating something both quickly but also future-friendly."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'1. Define the result\n\n2. Get it working\n    a. Define the high-level approach\n    b. Implement a rough end-to-end pipeline\n    c. Proxy as many details as possible (i.e. use the simplest\n       implementation I can that still is representative of what\n       I eventually want)\n\n3. Rinse-and-repeat step 2 until it works\n\n4. Make it better\n    a. Replace proxies with real implementations\n    b. Fill in details\n\n5. Scope to "good enough"\n    a. Repeat 4 until it feels "complete" even if it\'s not what I\n       fully wanted in 1\n    b. Recognize\n\n5. Code clean-up\n    a. Remember I won\'t remember what I had been thinking even a\n       week later, so code comments, naming, and general clean-up\n       are worth it\n\n6. Try to write something up about it\n    a. Writing up the work generally highlights things I may have\n       missed, especially around (1), (2a), and (5)\n'})}),"\n",(0,i.jsx)(n.p,{children:"In this particular case, looking at step (2c) the keys to getting something going were:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Cloning a fixed instance rather than using a real, position dependent terrain generator"}),"\n",(0,i.jsx)(n.li,{children:"Making that fixed instance something very simple"}),"\n",(0,i.jsx)(n.li,{children:"Making the potentially visible set logic very simple (just a fixed bounds)"}),"\n",(0,i.jsx)(n.li,{children:"Ignoring performance until I got it functionally working"}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>l});var i=t(6540);const o={},s=i.createContext(o);function a(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);